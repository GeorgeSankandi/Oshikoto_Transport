<h1 class="display-5">Provider Dashboard</h1>
<p class="lead">Welcome, {{user.name}}. Manage your services and bookings here.</p>
<hr>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="section-title mb-0">My Services</h3>
    <a href="/services/add" class="btn btn-primary">Add New Service</a>
</div>

{{!-- Services Table (Unchanged) --}}
{{#if services}}
<div class="table-responsive mb-5">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Price</th>
                <th>On Sale</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{#each services}}
            <tr>
                <td><a href="/services/{{_id}}">{{title}}</a></td>
                <td>{{category}}</td>
                <td>N$ {{price}}</td>
                <td>{{#if onSale}}Yes{{else}}No{{/if}}</td>
                <td>
                    <a href="/services/edit/{{_id}}" class="btn btn-sm btn-secondary">Edit</a>
                    <form action="/services/{{_id}}?_method=DELETE" method="POST" class="d-inline" onsubmit="return confirm('Delete this service?');">
                        <button type="submit" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                    </form>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>
{{else}}
<div class="card text-center p-4 mb-5">
    <p class="mb-0">You have not added any services yet. Click 'Add New Service' to begin.</p>
</div>
{{/if}}

<h3 class="section-title">Booking Requests</h3>
{{#if bookings}}
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
       <thead>
            <tr>
                <th>Client</th>
                <th>Service</th>
                <th>Date</th>
                <th>Status</th>
                <th>Checklist</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {{#each bookings}}
            <tr>
                <td>{{client.name}}</td>
                <td>{{service.title}}</td>
                <td>{{formatDate bookingDate 'MMMM Do YYYY'}}</td>
                <td>
                     <form action="/bookings/status/{{_id}}" method="POST" class="d-inline">
                        <select name="status" class="form-select form-select-sm" onchange="this.form.submit()">
                            {{#select status}}
                            <option value="Pending">Pending</option>
                            <option value="Confirmed">Confirmed</option>
                            <option value="Completed">Completed</option>
                            <option value="Cancelled">Cancelled</option>
                            {{/select}}
                        </select>
                    </form>
                </td>
                <td>
                    <a href="/dashboard/checklist/{{this._id}}" class="btn btn-sm {{#if this.hasChecklist}}btn-success{{else}}btn-secondary{{/if}}">
                        {{#if this.hasChecklist}}View/Edit{{else}}Fill{{/if}}
                    </a>
                    {{#if this.hasChecklist}}
                    <a href="/bookings/{{this._id}}/checklist/download" class="btn btn-sm btn-outline-dark" target="_blank" title="Download PDF"><i class="fas fa-download"></i></a>
                    {{/if}}
                </td>
                <td>
                    <form action="/bookings/{{this._id}}?_method=DELETE" method="POST" class="d-inline" onsubmit="return confirm('Decline and delete this booking request?');">
                        <button type="submit" class="btn btn-sm btn-danger">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>
{{else}}
<div class="card text-center p-4">
    <p class="mb-0">You have no booking requests at this time.</p>
</div>
{{/if}}